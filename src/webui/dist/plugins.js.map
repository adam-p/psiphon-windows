{"version":3,"sources":["../js/plugins.js"],"names":["method","noop","methods","length","console","window","factory","define","amd","module","exports","require","jQuery","$","$scrollTo","scrollTo","target","duration","settings","defaults","axis","limit","isWin","elem","nodeName","inArray","toLowerCase","fn","onAfter","extend","queue","offset","both","over","each","win","contentWindow","$elem","targ","attr","toff","test","is","style","isFunction","split","i","Pos","pos","key","prev","max","margin","parseInt","css","val","slice","parseFloat","Math","min","animate","onAfterFirst","callback","opts","complete","call","Dim","scroll","size","doc","ownerDocument","document","html","documentElement","body","isPlainObject","top","left","Tween","propHooks","scrollLeft","scrollTop","get","t","prop","set","curr","options","interrupt","_last","stop","next","round","now","sr","debounce","func","threshold","execAsap","timeout","debounced","obj","args","arguments","delayed","apply","clearTimeout","setTimeout","bind","trigger","Datastore","data","name","concat","random","_subscribers","EventTypes","change","_dispatch","path","type","subs","_","filter","s","startsWith","sub","_imm","isUndefined","objectPathImmutable","_eq","val1","val2","equality","isEqual","prototype","value","newData","oldVal","newVal","subscribe","String","unsubscribe","remove","push","I18n","init","translations","fallbackLocale","locales","Object","keys","Error","currentLocale","setLocale","locale","localeBestMatch","isRTL","defaultRTLLanguages","ltrScripts","rtlScripts","indexOf","translation","localizeUI","translatableElems","eq","text","rtl","desiredLocale","availableLocales","desiredLocaleParts","maxMatchScore","maxMatchLocale","translationLocale","translationLocaleParts","currentScore","j","k","i18n"],"mappings":"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","sourcesContent":["/*\n * Copyright (c) 2015, Psiphon Inc.\n * All rights reserved.\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n// ...Except third-party code below.\n\n\n// Avoid `console` errors in browsers that lack a console.\n(function() {\n    var method;\n    var noop = function () {};\n    var methods = [\n        'assert', 'clear', 'count', 'debug', 'dir', 'dirxml', 'error',\n        'exception', 'group', 'groupCollapsed', 'groupEnd', 'info', 'log',\n        'markTimeline', 'profile', 'profileEnd', 'table', 'time', 'timeEnd',\n        'timeline', 'timelineEnd', 'timeStamp', 'trace', 'warn'\n    ];\n    var length = methods.length;\n    var console = (window.console = window.console || {});\n\n    while (length--) {\n        method = methods[length];\n\n        // Only stub undefined methods.\n        if (!console[method]) {\n            console[method] = noop;\n        }\n    }\n}());\n\n// Place any jQuery/helper plugins in here.\n\n\n/*!\n * jQuery.scrollTo\n * Copyright (c) 2007 Ariel Flesler - aflesler ○ gmail • com | https://github.com/flesler\n * Licensed under MIT\n * https://github.com/flesler/jquery.scrollTo\n * @projectDescription Lightweight, cross-browser and highly customizable animated scrolling with jQuery\n * @author Ariel Flesler\n * @version 2.1.2\n */\n;\n(function (factory) {\n  'use strict';\n  if (typeof define === 'function' && define.amd) {\n    // AMD\n    define(['jquery'], factory);\n  } else if (typeof module !== 'undefined' && module.exports) {\n    // CommonJS\n    module.exports = factory(require('jquery'));\n  } else {\n    // Global\n    factory(jQuery);\n  }\n})(function ($) {\n  'use strict';\n\n  var $scrollTo = $.scrollTo = function (target, duration, settings) {\n    return $(window).scrollTo(target, duration, settings);\n  };\n\n  $scrollTo.defaults = {\n    axis: 'xy',\n    duration: 0,\n    limit: true\n  };\n\n  function isWin(elem) {\n    return !elem.nodeName ||\n      $.inArray(elem.nodeName.toLowerCase(), ['iframe', '#document', 'html', 'body']) !== -1;\n  }\n\n  $.fn.scrollTo = function (target, duration, settings) {\n    if (typeof duration === 'object') {\n      settings = duration;\n      duration = 0;\n    }\n    if (typeof settings === 'function') {\n      settings = {\n        onAfter: settings\n      };\n    }\n    if (target === 'max') {\n      target = 9e9;\n    }\n\n    settings = $.extend({}, $scrollTo.defaults, settings);\n    // Speed is still recognized for backwards compatibility\n    duration = duration || settings.duration;\n    // Make sure the settings are given right\n    var queue = settings.queue && settings.axis.length > 1;\n    if (queue) {\n      // Let's keep the overall duration\n      duration /= 2;\n    }\n    settings.offset = both(settings.offset);\n    settings.over = both(settings.over);\n\n    return this.each(function () {\n      // Null target yields nothing, just like jQuery does\n      if (target === null) return;\n\n      var win = isWin(this),\n        elem = win ? this.contentWindow || window : this,\n        $elem = $(elem),\n        targ = target,\n        attr = {},\n        toff;\n\n      switch (typeof targ) {\n        // A number will pass the regex\n        case 'number':\n        case 'string':\n          if (/^([+-]=?)?\\d+(\\.\\d+)?(px|%)?$/.test(targ)) {\n            targ = both(targ);\n            // We are done\n            break;\n          }\n          // Relative/Absolute selector\n          targ = win ? $(targ) : $(targ, elem);\n          /* falls through */\n        case 'object':\n          if (targ.length === 0) return;\n          // DOMElement / jQuery\n          if (targ.is || targ.style) {\n            // Get the real position of the target\n            toff = (targ = $(targ)).offset();\n          }\n      }\n\n      var offset = $.isFunction(settings.offset) && settings.offset(elem, targ) || settings.offset;\n\n      $.each(settings.axis.split(''), function (i, axis) {\n        var Pos = axis === 'x' ? 'Left' : 'Top',\n          pos = Pos.toLowerCase(),\n          key = 'scroll' + Pos,\n          prev = $elem[key](),\n          max = $scrollTo.max(elem, axis);\n\n        if (toff) { // jQuery / DOMElement\n          attr[key] = toff[pos] + (win ? 0 : prev - $elem.offset()[pos]);\n\n          // If it's a dom element, reduce the margin\n          if (settings.margin) {\n            attr[key] -= parseInt(targ.css('margin' + Pos), 10) || 0;\n            attr[key] -= parseInt(targ.css('border' + Pos + 'Width'), 10) || 0;\n          }\n\n          attr[key] += offset[pos] || 0;\n\n          if (settings.over[pos]) {\n            // Scroll to a fraction of its width/height\n            attr[key] += targ[axis === 'x' ? 'width' : 'height']() * settings.over[pos];\n          }\n        } else {\n          var val = targ[pos];\n          // Handle percentage values\n          attr[key] = val.slice && val.slice(-1) === '%' ?\n            parseFloat(val) / 100 * max :\n            val;\n        }\n\n        // Number or 'number'\n        if (settings.limit && /^\\d+$/.test(attr[key])) {\n          // Check the limits\n          attr[key] = attr[key] <= 0 ? 0 : Math.min(attr[key], max);\n        }\n\n        // Don't waste time animating, if there's no need.\n        if (!i && settings.axis.length > 1) {\n          if (prev === attr[key]) {\n            // No animation needed\n            attr = {};\n          } else if (queue) {\n            // Intermediate animation\n            animate(settings.onAfterFirst);\n            // Don't animate this axis again in the next iteration.\n            attr = {};\n          }\n        }\n      });\n\n      animate(settings.onAfter);\n\n      function animate(callback) {\n        var opts = $.extend({}, settings, {\n          // The queue setting conflicts with animate()\n          // Force it to always be true\n          queue: true,\n          duration: duration,\n          complete: callback && function () {\n            callback.call(elem, targ, settings);\n          }\n        });\n        $elem.animate(attr, opts);\n      }\n    });\n  };\n\n  // Max scrolling position, works on quirks mode\n  // It only fails (not too badly) on IE, quirks mode.\n  $scrollTo.max = function (elem, axis) {\n    var Dim = axis === 'x' ? 'Width' : 'Height',\n      scroll = 'scroll' + Dim;\n\n    if (!isWin(elem))\n      return elem[scroll] - $(elem)[Dim.toLowerCase()]();\n\n    var size = 'client' + Dim,\n      doc = elem.ownerDocument || elem.document,\n      html = doc.documentElement,\n      body = doc.body;\n\n    return Math.max(html[scroll], body[scroll]) - Math.min(html[size], body[size]);\n  };\n\n  function both(val) {\n    return $.isFunction(val) || $.isPlainObject(val) ? val : {\n      top: val,\n      left: val\n    };\n  }\n\n  // Add special hooks so that window scroll properties can be animated\n  $.Tween.propHooks.scrollLeft =\n    $.Tween.propHooks.scrollTop = {\n      get: function (t) {\n        return $(t.elem)[t.prop]();\n      },\n      set: function (t) {\n        var curr = this.get(t);\n        // If interrupt is true and user scrolled, stop animating\n        if (t.options.interrupt && t._last && t._last !== curr) {\n          return $(t.elem).stop();\n        }\n        var next = Math.round(t.now);\n        // Don't waste CPU\n        // Browsers don't render floating point scroll\n        if (curr !== next) {\n          $(t.elem)[t.prop](next);\n          t._last = this.get(t);\n        }\n      }\n    };\n\n  // AMD requirement\n  return $scrollTo;\n});\n\n// Smarter resize event\n// http://www.paulirish.com/2009/throttled-smartresize-jquery-event-handler/\n(function($,sr){\n  // debouncing function from John Hann\n  // http://unscriptable.com/index.php/2009/03/20/debouncing-javascript-methods/\n  var debounce = function (func, threshold, execAsap) {\n      var timeout;\n\n      return function debounced () {\n          var obj = this, args = arguments;\n          function delayed () {\n              if (!execAsap)\n                  func.apply(obj, args);\n              timeout = null;\n          }\n\n          if (timeout)\n              clearTimeout(timeout);\n          else if (execAsap)\n              func.apply(obj, args);\n\n          timeout = setTimeout(delayed, threshold || 100);\n      };\n  };\n  // smartresize\n  jQuery.fn[sr] = function(fn){  return fn ? this.bind('resize', debounce(fn)) : this.trigger(sr); };\n\n})(jQuery,'smartresize');\n\n\n/*\nDatastore example:\n\nconst store = new Datastore({\n   obj: {\n     nestedObj: {\n       a: 'a',\n       b: 'b'\n     }\n   },\n   integer: 123,\n   array: [1, 2, 3]\n});\n\nconst unsub = store.subscribe('obj.nestedObj.a', (path, data, type) => {\n   console.log('deeper', path, data, type);\n   // unsubscribe\n   unsub();\n});\n\nstore.subscribe('obj.nestedObj', (path, data, type) => {\n   console.log('shallower', path, data, type);\n});\n\nstore.set('obj.nestedObj.c', 'c'); // add a new property\n// >> shallower obj.nestedObj {a: \"a\", b: \"b\", c: \"c\"} change\n\nstore.set('obj.nestedObj.a', 'aa'); // will trigger both subscribers\n// >> deeper obj.nestedObj.a aa change\n// >> shallower obj.nestedObj {a: \"aa\", b: \"b\", c: \"c\"} change\n\n// Does nothing, as the value is unchanged.\nstore.set('obj.nestedObj.a', 'aa');\n\n// Value is still unchanged, but we're specifying a `false` equality operator, so the\n// subscriptions will fire.\nstore.set('obj.nestedObj.a', 'aa', false);\n// >> shallower obj.nestedObj {a: \"aa\", b: \"b\", c: \"c\"} change\n// The deeper subscription already unsubscribed itself.\n\n// The underlying data can be accessed directly. But don't modify it, unless you're trying\n// to bypass the immutability and pubsub!\nconsole.dir(store.data);\n\nThis example has been left out of @example tags so as to not flood the pop-up help.\n*/\n\n/**\n * A state and data store featuring immutability of the underlying object and ability to\n * subscribe to changes.\n * For immutability this library is required: https://github.com/mariocasciaro/object-path-immutable\n * For object-path subscribing and access, lodash is required: https://lodash.com/docs/3.10.1#get\n * @param {object} data The initial data structure. For ease of code understandability,\n *                      this should be approximately the structure the data will always have.\n * @param {?string} name The name of the store; used only for help logging and debugging.\n */\nfunction Datastore(data, name) {\n  /**\n   * The name of the datastore\n   * @type {string}\n   * @readonly\n   */\n  this.name = name || \"Datastore-\".concat(Math.random());\n\n  /**\n   * The underlying data object. This can be read directly to access the data, but should\n   * NOT be modified (unless you're specifically trying to avoid immutability and\n   * subscriber notifications).\n   * @type {object}\n   */\n  this.data = data;\n\n  /**\n   * [{path: \"a.b.c\", func: callback, key: unique},...]\n   */\n  this._subscribers = [];\n\n  /**\n   * The possible event types.\n   * TODO: Are types even necessary? Right now we only use 'change'.\n   * @enum {string}\n   * @readonly\n   */\n  this.EventTypes = {\n    change: 'change'\n  };\n\n  /**\n   * Send the specified change to the subscribers.\n   * @param {string} path The object-path of the change.\n   * @param {EventTypes} type The type of the change.\n   */\n  this._dispatch = function(path, type) {\n    // this.data might change (immutably) during the timeout, so capture the current\n    // object now.\n    const data = this.data;\n\n    // Ensure this is asynchronous\n    setTimeout(()=> {\n      // When looking for subscribers, we look at prefixes of paths, as whole sub-trees\n      // can be subscribed to.\n      const subs = _.filter(this._subscribers, (s) => {\n        // We append '.' because we want \"a.b\" to match \"a.b.c\" but not \"a.banana\".\n        return _.startsWith(path+'.', s.path+'.');\n      });\n\n      for (let i = 0; i < subs.length; i++) {\n        let sub = subs[i];\n        // The amount of data (tree or specific value) that a subscriber gets depends on\n        // what they are subscribed to.\n        sub.func(sub.path, _.get(data, sub.path), type);\n      }\n    }, 0);\n  };\n\n  /**\n   * Returns data wrapped with https://github.com/mariocasciaro/object-path-immutable\n   * @param {object} data If falsy, this.data will be wrapped.\n   * @returns {objectPathImmutable}\n   */\n  this._imm = function(data) {\n    if (!_.isUndefined(data)) {\n      return objectPathImmutable(data);\n    }\n    return objectPathImmutable(this.data);\n  };\n\n  /**\n   * Check if val1 and val2 are equal, using equality or _.isEqual if not supplied.\n   * @param {any} val1\n   * @param {any} val2\n   * @param {?(function|boolean)} equality The equality comparison function. If not\n   *    supplied, _.isEqual (deep equality) will be used. If `false`, no equality comparison\n   *    will be done. If supplied, it must take val1 and val2 and return a boolean.\n   * @returns {boolean}\n   */\n  this._eq = function(val1, val2, equality) {\n    if (equality === false) {\n      // Caller doesn't want the equality check\n      return false;\n    }\n    if (equality) {\n      return equality(val1, val2);\n    }\n    return _.isEqual(val1, val2);\n  };\n}\n\nDatastore.prototype = {\n  /**\n   * Add or modify a value in the data.\n   * For path details see: https://github.com/mariocasciaro/object-path-immutable\n   * However, the string form _must_ be used.\n   * @param {string} path The object-path to set. Like 'a' or 'a.b'.\n   * @param {any} value The value to set.\n   * @param {?(function|boolean)} equality The equality comparison function. If not\n   *    supplied, _.isEqual (deep equality) will be used. If `false`, no equality comparison\n   *    will be done. If supplied, it must take old and new values and return a boolean.\n   */\n  set: function(path, value, equality) {\n    const newData = this._imm().set(path, value).value();\n    const oldVal = _.get(this.data, path);\n    const newVal = _.get(newData, path);\n\n    if (this._eq(oldVal, newVal, equality)) {\n      // No change; don't update or dispatch\n      return;\n    }\n\n    // Update our data\n    this.data = newData;\n    // Tell the subscribers\n    this._dispatch(path, this.EventTypes.change);\n  },\n\n  // TODO: Add needed API shims for https://github.com/mariocasciaro/object-path-immutable\n\n  /**\n   * Subscribe to changes in the data store, for changes at or below path; when changes\n   * occur func will be called.\n   * @param {string} path The object-path that will be subscribed to. This can be a leaf\n   *    value or branch higher up. The dotted-string form of the path must be used.\n   *    If falsy or '', the subscription will be to the whole data object.\n   * @param {function} func The function that will be called whenever a value at or under\n   *    the path is changed. It will be called like `func(path, data, type)`, where `path`\n   *    is the same path passed in here, `data` is the data at that path (possibly a\n   *    subtree if subscribe to a non-leaf), and `type` will be one of `EventTypes`,\n   *    depending on the change type.\n   * @returns {function} The unsubscribe function.\n   */\n  subscribe: function(path, func) {\n    // Empty string works as subscribe-to-all because _.startsWith will always return true for it.\n    path = path || '';\n\n    const key = String(Math.random());\n    const unsubscribe = () => {\n      _.remove(this._subscribers, (s) => { return s.key === key; });\n    };\n    this._subscribers.push({func, path, key});\n    return unsubscribe;\n  }\n};\n\n\n/**\n * Internationalization helper. Must be initialized before use.\n * Should be accessed via `window.i18n`, with the exception of `I18n.localeBestMatch`.\n */\nfunction I18n() {\n\n  /**\n   * Initializes this object.\n   * @param {Object} translations The set of translations available to us.\n   *    Must be of the form `{en: {translation:{key1:\"string1\",key2:\"string2\",...}}, ...}\n   * @param {string} fallbackLocale The locale to use if a string key is missing from a translation,\n   *    or if `setLocale` is passed a locale that it can't find a match for.\n   */\n  this.init = function(translations, fallbackLocale) {\n    this.translations = translations;\n    this.locales = Object.keys(translations);\n\n    if (!this.translations[fallbackLocale]) {\n      throw new Error(`fallbackLocale '${fallbackLocale}' must exactly match a locale in translations`);\n    }\n    this.fallbackLocale = fallbackLocale;\n    this.currentLocale = this.fallbackLocale;\n  };\n\n  /**\n   * Sets the current locale of this object to a best match of `locale`. If UI l10n\n   * update is also desired, `localizeUI` should be called after this.\n   * @param {string} locale\n   */\n  this.setLocale = function(locale) {\n    this.currentLocale = I18n.localeBestMatch(locale, this.locales) || this.fallbackLocale;\n  };\n\n  /**\n   * Returns true if the current locale is RTL, false otherwise.\n   * @returns {boolean}\n   */\n  this.isRTL = function() {\n    // Factors to keep in mind:\n    // - some languages are RTL in their default script; like Arabic and Hebrew\n    // - some languages sometimes use Arabic script, but not by default; like Kazakh\n    // - any locale can have the `Arab` script set and become RTL (probably other\n    //   scripts as well, but that's the only one we'll check for)\n    const defaultRTLLanguages = ['devrtl', 'fa', 'ar', 'ug', 'ur', 'he', 'ps', 'sd'];\n    // This isn't all of them, but the ones we might reasonably encounter combined with an RTL language. We may need to expand this with time.\n    const ltrScripts = ['Latn', 'Cyrl', 'Deva'];\n    // We may need to expand this with time.\n    const rtlScripts = ['Arab'];\n\n    // Note that script names are always four characters, and language and country codes\n    // are always 2 characters, so we're not going to accidentally match a script name.\n\n    // Do we have an explicit RTL script?\n    for (let i = 0; i < rtlScripts.length; i++) {\n      if (this.currentLocale.toLowerCase().indexOf(rtlScripts[i].toLowerCase()) >= 0) { // eslint-disable-line\n        return true;\n      }\n    }\n\n    // Do we have an explicit LTR script?\n    for (let i = 0; i < ltrScripts.length; i++) {\n      if (this.currentLocale.toLowerCase().indexOf(ltrScripts[i].toLowerCase()) >= 0) { // eslint-disable-line\n        return false;\n      }\n    }\n\n    // Does the current language default to RTL?\n    for (let i = 0; i < defaultRTLLanguages.length; i++) {\n      if (this.currentLocale.toLowerCase().startsWith(defaultRTLLanguages[i].toLowerCase())) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  /**\n   * Find the string corresponding to `key` for the current locale (falling back if\n   * necessary). If the key can't be found, an exception will be thrown.\n   * @param {string} key\n   * @returns {string}\n   */\n  this.t = function(key) {\n    const translation = this.translations[this.currentLocale].translation[key]\n                        || this.translations[this.fallbackLocale].translation[key];\n    if (!translation) {\n      throw new Error(`failed to find translation for key '${key}' and locale '${this.currentLocale}'`);\n    }\n    return translation;\n  };\n\n  /**\n   * Update the UI with translations for the current locale.\n   */\n  this.localizeUI = function() {\n    const translatableElems = $('[data-i18n]');\n    for (let i = 0; i < translatableElems.length; i++) {\n      const elem = translatableElems.eq(i);\n      const key = elem.data('i18n');\n      if (key.startsWith('[html]')) {\n        elem.html(this.t(key.slice('[html]'.length)));\n      }\n      else {\n        elem.text(this.t(key));\n      }\n    }\n\n    $('html').attr('lang', this.currentLocale);\n    const rtl = this.isRTL();\n    $('body').attr('dir', rtl ? 'rtl' : 'ltr')\n             .css('direction', rtl ? 'rtl' : 'ltr');\n  };\n\n  /**\n   * Finds the best match for `desiredLocale` among `availableLocales`. Returns a locale\n   * from `availableLocales`, or `null` if no acceptable match can be found.\n   * @param {string} desiredLocale\n   * @param {string[]} availableLocales\n   * @returns {?string}\n   */\n  /* Adheres to this behaviour:\n  [\n    {\n      _desc: 'Exact match',\n      desiredLocale: 'zh-Hans-CN',\n      availableLocales: ['en', 'zh-Hans-CN', 'zh'],\n      want: 'zh-Hans-CN'\n    },\n    {\n      _desc: 'Language-only match',\n      desiredLocale: 'zh-Hans-CN',\n      availableLocales: ['en', 'zh', 'de'],\n      want: 'zh'\n    },\n    {\n      _desc: 'Language+script match',\n      desiredLocale: 'zh-Hans-CN',\n      availableLocales: ['en', 'zh', 'zh-Hans', 'zh-Hant-TW', 'de'],\n      want: 'zh-Hans'\n    },\n    {\n      _desc: 'Language+country match',\n      desiredLocale: 'zh-Hans-CN',\n      availableLocales: ['en', 'zh', 'zh-CN', 'zh-Hant-TW', 'de'],\n      want: 'zh-CN'\n    },\n    {\n      _desc: 'Case-insensitive best match',\n      desiredLocale: 'ZH-HANS-CN',\n      availableLocales: ['en-US', 'zh-TW', 'de-DE'],\n      want: 'zh-TW'\n    },\n    {\n      _desc: 'Shortest best match',\n      desiredLocale: 'zh-Hans-CN',\n      availableLocales: ['en-US', 'zh-XX', 'zh', 'zh-TW', 'de-DE'],\n      want: 'zh'\n    },\n    {\n      _desc: 'Equally good matches will be determined by input order; part 1',\n      desiredLocale: 'zh-XX-YY',\n      availableLocales: ['en-US', 'zh-XX', 'zh', 'zh-YY', 'de-DE'],\n      want: 'zh-XX'\n    },\n    {\n      _desc: 'Equally good matches will be determined by input order; part 2',\n      desiredLocale: 'zh-XX-YY',\n      availableLocales: ['en-US', 'zh-YY', 'zh', 'zh-XX', 'de-DE'],\n      want: 'zh-YY'\n    },\n  ].forEach((test) => {\n    const got = I18n.localeBestMatch(test.desiredLocale, test.availableLocales);\n    if (got !== test.want) {\n      throw new Error(`test failed: \"${test._desc}\"; got \"${got}\"; wanted \"${test.want}\"`)\n    }\n    console.log(`pass: ${test._desc}`);\n  });\n  console.log('all tests passed');\n  */\n  I18n.localeBestMatch = function(desiredLocale, availableLocales) {\n    // Our translation locales are like 'en', 'en-Latn', 'en-US', or 'en-Latn-US' (BCP 47 subset).\n    // `localeID` can also be like any of those, but not necessarily the same.\n    // We want to match intelligently.\n\n    // First try to match exactly. This is case sensitive. If there's a match that\n    // requires case-insensitivity, it will be found below.\n    for (let i = 0; i < availableLocales.length; i++) {\n      if (availableLocales[i] === desiredLocale) {\n        return desiredLocale;\n      }\n    }\n\n    // We'll break the IDs up into pieces and try to find a best match that must include\n    // the first, language, part.\n    const desiredLocaleParts = desiredLocale.toLowerCase().split('-');\n\n    let maxMatchScore = 0, maxMatchLocale = null;\n\n    for (let i = 0; i < availableLocales.length; i++) {\n      const translationLocale = availableLocales[i];\n      const translationLocaleParts = translationLocale.toLowerCase().split('-');\n      if (translationLocaleParts[0] !== desiredLocaleParts[0]) {\n        // The language part must match.\n        continue;\n      }\n\n      let currentScore = 1;\n\n      for (let j = 1; j < desiredLocaleParts.length; j++) {\n        for (let k = 1; k < translationLocaleParts.length; k++) {\n          if (desiredLocaleParts[j] === translationLocaleParts[k]) {\n            currentScore += 1;\n          }\n        }\n      }\n\n      if (currentScore > maxMatchScore) {\n        maxMatchScore = currentScore;\n        maxMatchLocale = translationLocale;\n      }\n      else if (currentScore === maxMatchScore) {\n        // We're going to break ties by preferring the shortest locale. This allows us,\n        // for example, to prefer \"zh\" over \"zh-TW\" for \"zh-CN\" and \"zh-Hans-CN\".\n        if (translationLocale.length < maxMatchLocale.length) {\n          maxMatchScore = currentScore;\n          maxMatchLocale = translationLocale;\n        }\n      }\n    }\n\n    return maxMatchLocale;\n  };\n\n}\n\nwindow.i18n = new I18n();\n"],"file":"plugins.js"}